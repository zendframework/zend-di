<!DOCTYPE html>
<html lang="en">


<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Automated dependency injection for PSR-11 containers">  
    <link rel="shortcut icon" href="../../img/favicon.ico">

    <title>Dependency Definitions - zend-di</title>

    <link rel="stylesheet" href="../../css/styles-e95dab66f8.css">
</head>
<body id="page-top">

    
    <div class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">

            
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            
            <span class="navbar-brand">
                <a class="logo-link" href="https://framework.zend.com/" data-tooltip data-placement="bottom" title="Go to the ZF homepage">
                    <img src="../../img/zend-framework-logo.svg" height="28" alt="Zend Framework">
                </a>
            </span>
        </div>

        <div class="navbar-collapse collapse">

            
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="https://framework.zend.com/about">About</a>
                </li>
                <li>
                    <a href="https://framework.zend.com/downloads">Install</a>
                </li>
                <li class="active">
                    <a href="https://docs.zendframework.com">Documentation</a>
                </li>
                <li>
                    <a href="https://www.zend.com/en/services/training">Training</a>
                </li>
                <li>
                    <a href="https://framework.zend.com/blog">Blog</a>
                </li>
                <li>
                    <a href="https://framework.zend.com/participate">Participate</a>
                </li>
            </ul>

            
            
                <div class="nav navbar-nav navbar-collapse visible-xs-block ">
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="../..">zend-di</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            
                
                    <li class="subnavigation__list-item ">
                        <a href="../../intro/" class="subnavigation__link">Introduction</a>
                    </li>
                
            
                
                    <li class="subnavigation__list-item ">
                        <a href="../../quick-start/" class="subnavigation__link">Quick Start</a>
                    </li>
                
            
                
                    <li class="subnavigation__list-item">
                        <span class="subnavigation__headline">Reference</span>
                        <ul class="subnavigation__list">
                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../psr-11/" class="subnavigation__link">PSR-11 Support</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../config/" class="subnavigation__link">Configuration</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../injector/" class="subnavigation__link">Injector</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../codegen/" class="subnavigation__link">Code Generator</a>
    </li>

                            
                                
    <li class="subnavigation__list-item">
        <span class="subnavigation__headline">v2 Documentation</span>
        <ul class="subnavigation__list">
            
                
    <li class="subnavigation__list-item subnavigation__list-item--active">
        <a href="./" class="subnavigation__link">Dependency Definitions</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../instance-manager/" class="subnavigation__link">Instance Manager</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../config/" class="subnavigation__link">Configuration</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../debugging-and-complex-use-cases/" class="subnavigation__link">Debugging And Complex Use Cases</a>
    </li>

            
        </ul>
    </li>

                            
                        </ul>
                    </li>
                
            
                
                    <li class="subnavigation__list-item">
                        <span class="subnavigation__headline">Cookbook</span>
                        <ul class="subnavigation__list">
                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../cookbook/use-with-psr-containers/" class="subnavigation__link">Usage with PSR-11 Containers</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../cookbook/use-with-servicemanager/" class="subnavigation__link">Usage with zend-servicemanager</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../cookbook/aot-guide/" class="subnavigation__link">Using AoT with Expressive and zend-servicemanager</a>
    </li>

                            
                        </ul>
                    </li>
                
            
                
                    <li class="subnavigation__list-item ">
                        <a href="../../migration/" class="subnavigation__link">Migration Guide</a>
                    </li>
                
            
        </ul>
    </div>

                </div>
            

            
            <div class="nav navbar-nav navbar-collapse visible-xs-block">
                <div class="component-selector">
    <h4 class="component-selector__title">Components</h4>
    <h5 class="component-selector__subtitle">Find documentation…</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
            </div>
        </div>
    </div>
</div>

    
    <header class="header">
    <div class="container">
        <div class="row">

            
            <div class="col-xs-8">
                <h1 class="header__title">
                    Documentation

                    
                        <small class="header__subtitle">zend-di</small>
                    
                </h1>
            </div>

            
            <div class="col-xs-4 text-right">
                
                    <a href="#" class="header__link header__link--search" data-toggle="modal" data-target="#mkdocs_search_modal" title="Open search">
                        <i class="fa fa-search"></i> Search
                    </a>
                    <a href="https://github.com/zendframework/zend-di/" class="header__link header__link--github" title="Go to repository of zend-di">
                        <i class="fa fa-github"></i> GitHub
                    </a>
                
            </div>
        </div>
    </div>
</header>

    
    <div class="container">
        <div class="row">
            <div class="col-md-9 col-xs-12 content" role="main">
            <!-- content:begin -->
                
                    <ol class="breadcrumb" role="navigation" aria-label="breadcrumbs navigation">
    <li><a href="https://framework.zend.com/">Home</a></li>

    
        <li><a href="https://docs.zendframework.com/">Documentation</a></li>

        
            <li><a href="../..">zend-di</a></li>

            
                
                    <li>Reference</li>
                
            
                
                    <li>v2 Documentation</li>
                
            

            <li class="active">Dependency Definitions</li>
        
    
</ol>


    
    

    
    
        <div class="toc">
            <h6 class="toc__headline">In This Article</h6>
            <ul class="toc__list">
                
                    <li class="toc__entry">
                        <a href="#version-2" class="toc__link">Version 2</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#definitionlist" class="toc__link">DefinitionList</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#runtimedefinition" class="toc__link">RuntimeDefinition</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#compilerdefinition" class="toc__link">CompilerDefinition</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#classdefinition" class="toc__link">ClassDefinition</a>
                    </li>
                
            </ul>
        </div>
    


    <h1 id="dependency-definitions">Dependency Definitions</h1>
<blockquote>
<h3 id="version-2">Version 2</h3>
<p>This is documentation for the legacy version (2.x) of zend-di.</p>
</blockquote>
<p>Definitions are what zend-di uses to understand the structure of the code it is
attempting to wire. This means that if you've written non-ambiguous, clear, and
concise code, zend-di has a very good chance of understanding how to wire things
up without much added complexity.</p>
<h2 id="definitionlist">DefinitionList</h2>
<p>Definitions are introduced to the <code>Zend\Di\Di</code> object through a definition list
implemented as <code>Zend\Di\DefinitionList</code> (which extends <code>SplDoublyLinkedList</code>).
Order is important. Definitions in the front of the list will be consulted on a
class before definitions at the end of the list.</p>
<blockquote>
<h3 id="autoloading">Autoloading</h3>
<p>Regardless of what kind of <code>DefinitionList</code> strategy you decide to use, it is
important that your autoloaders are already setup and ready to use.</p>
</blockquote>
<h2 id="runtimedefinition">RuntimeDefinition</h2>
<p>The default <code>DefinitionList</code> instantiated by <code>Zend\Di\Di</code> when no other
DefinitionList is provided is <code>Zend\Di\Definition\RuntimeDefinition</code>. The
<code>RuntimeDefinition</code> will respond to queries about classes by using PHP's
Reflection API. The <code>RuntimeDefinition</code> uses any available information inside
methods &mdash; including their signature, the names of parameters, the
type-hints of the parameters, and the default values &mdash; to determine if
something is optional or required when making a call to that method. The more
explicit you can be in your method naming and method signatures, the more likely
<code>Zend\Di\Definition\RuntimeDefinition</code> will accurately understand the structure
of your code.</p>
<p>The constructor of <code>RuntimeDefinition</code> looks like the following:</p>
<pre class="codehilite"><code class="language-php">public function __construct(
    IntrospectionStrategy $introspectionStrategy = null,
    array $explicitClasses = null
) {
    $this-&gt;introspectionStrategy = $introspectionStrategy ?: new IntrospectionStrategy();
    if ($explicitClasses) {
        $this-&gt;setExplicitClasses($explicitClasses);
    }
}</code></pre>

<p>The <code>IntrospectionStrategy</code> object is an object that defines the rules by which
the <code>RuntimeDefinition</code> will introspect information about your classes. Here are
the things it knows how to do:</p>
<ul>
<li>
<p>Whether or not to use annotations (scanning and parsing annotations is
  expensive, and thus disabled by default).</p>
</li>
<li>
<p>Which method names to include in the introspection; this is a list of
  patterns. By default, it registers the pattern <code>/^set\[A-Z\]{1}\\w\*/</code>.</p>
</li>
<li>
<p>Which interface names represent the interface injection pattern; this is a
  list of patterns. By default, the pattern <code>/\\w\*Aware\\w\*/</code> is registered.</p>
</li>
</ul>
<p>The constructor for the <code>IntrospectionStrategy</code> looks like this:</p>
<pre class="codehilite"><code class="language-php">public function __construct(AnnotationManager $annotationManager = null)
{
    $this-&gt;annotationManager = $annotationManager ?: $this-&gt;createDefaultAnnotationManager();
}</code></pre>

<p>The <code>AnnotationManager</code> is not required. If you wish to create a special
<code>AnnotationManager</code> with your own annotations, and also wish to extend the
<code>RuntimeDefinition</code> to look for those annotations, this is the place to do it.</p>
<p>The <code>RuntimeDefinition</code> also can be used to look up either all classes
(implicitly, which is default), or explicitly look up for particular pre-defined
classes. This is useful when your strategy for inspecting one set of classes
might differ from those of another strategy for another set of classes. This can
be achieved by using the <code>setExplicitClasses()</code> method or by passing a list of
classes as the second constructor argument of the <code>RuntimeDefinition</code>.</p>
<h2 id="compilerdefinition">CompilerDefinition</h2>
<p>The <code>CompilerDefinition</code> is similar in nature to the <code>RuntimeDefinition</code> with
the exception that it can be seeded with more information for the purposes of
"compiling" a definition. Compiled definitions eliminate reflection calls and
annotation scannning, which can be a performance bottleneck in your production
applications.</p>
<p>For example, let's assume we want to create a script that will create
definitions for some of our library code:</p>
<pre class="codehilite"><code class="language-php">// in &quot;package name&quot; format
$components = [
    'My_MovieApp',
    'My_OtherClasses',
];

foreach ($components as $component) {
    $diCompiler = new Zend\Di\Definition\CompilerDefinition;
    $diCompiler-&gt;addDirectory('/path/to/classes/' . str_replace('_', '/', $component));

    $diCompiler-&gt;compile();
    file_put_contents(
        __DIR__ . '/../data/di/' . $component . '-definition.php',
        '&lt;?php return ' . var_export($diCompiler-&gt;toArrayDefinition()-&gt;toArray(), true) . ';'
    );
}</code></pre>

<p>The above creates a file for each "package", containing the full definition for
the classes defined for each. To utilize this in an application, use the
following:</p>
<pre class="codehilite"><code class="language-php">protected function setupDi(Application $app)
{
    $definitionList = new DefinitionList([
        new Definition\ArrayDefinition(include __DIR__ .  '/path/to/data/di/My_MovieApp-definition.php'),
        new Definition\ArrayDefinition(include __DIR__ .  '/path/to/data/di/My_OtherClasses-definition.php'),
        $runtime = new Definition\RuntimeDefinition(),
    ]);
    $di = new Di($definitionList, null, new Config($this-&gt;config-&gt;di));
    $di-&gt;instanceManager()-&gt;addTypePreference('Zend\Di\LocatorInterface', $di);
    $app-&gt;setLocator($di);
}</code></pre>

<p>The above code would more than likely go inside your application's bootstrap or
within a <code>Module</code> class. This represents the simplest and most performant way
of configuring your DiC for usage.</p>
<h2 id="classdefinition">ClassDefinition</h2>
<p>The idea behind using a <code>ClassDefinition</code> is two-fold. First, you may want to
override some information inside of a <code>RuntimeDefinition</code>. Secondly, you might
want to simply define your complete class's definition with an xml, ini, or php
file describing the structure. This class definition can be fed in via
<code>Configuration</code> or by directly instantiating and registering the <code>Definition</code>
with the <code>DefinitionList</code>.</p>



    <nav>
    <ul class="page-nav hidden-print">

        
        <li class="page-nav__item">
            
                <a rel="prev" class="page-nav__link page-nav__link--prev" href="../../codegen/">
                    <i class="fa fa-chevron-left"></i> Previous
                </a>
            
        </li>

        
        <li class="page-nav__item">
            
                <a rel="next" class="page-nav__link page-nav__link--next" href="../instance-manager/">
                    Next <i class="fa fa-chevron-right"></i>
                </a>
            
        </li>
    </ul>
</nav>



    <div class="help-wanted">
        <p>
            Found a mistake or want to contribute to the documentation?
            <a href="https://github.com/zendframework/zend-di/edit/master/docs/book/v2/definitions.md" target="_blank" class="help-wanted__link">
                Edit this page on GitHub!
            </a>
        </p>
    </div>

                
            <!-- content:end -->
            </div>
            <div class="col-md-3 col-xs-12 sidebar">
                
                    <div class="component-selector">
    <h4 class="component-selector__title">Components</h4>
    <h5 class="component-selector__subtitle">Find documentation…</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="../..">zend-di</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            
                
                    <li class="subnavigation__list-item ">
                        <a href="../../intro/" class="subnavigation__link">Introduction</a>
                    </li>
                
            
                
                    <li class="subnavigation__list-item ">
                        <a href="../../quick-start/" class="subnavigation__link">Quick Start</a>
                    </li>
                
            
                
                    <li class="subnavigation__list-item">
                        <span class="subnavigation__headline">Reference</span>
                        <ul class="subnavigation__list">
                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../psr-11/" class="subnavigation__link">PSR-11 Support</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../config/" class="subnavigation__link">Configuration</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../injector/" class="subnavigation__link">Injector</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../codegen/" class="subnavigation__link">Code Generator</a>
    </li>

                            
                                
    <li class="subnavigation__list-item">
        <span class="subnavigation__headline">v2 Documentation</span>
        <ul class="subnavigation__list">
            
                
    <li class="subnavigation__list-item subnavigation__list-item--active">
        <a href="./" class="subnavigation__link">Dependency Definitions</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../instance-manager/" class="subnavigation__link">Instance Manager</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../config/" class="subnavigation__link">Configuration</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../debugging-and-complex-use-cases/" class="subnavigation__link">Debugging And Complex Use Cases</a>
    </li>

            
        </ul>
    </li>

                            
                        </ul>
                    </li>
                
            
                
                    <li class="subnavigation__list-item">
                        <span class="subnavigation__headline">Cookbook</span>
                        <ul class="subnavigation__list">
                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../cookbook/use-with-psr-containers/" class="subnavigation__link">Usage with PSR-11 Containers</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../cookbook/use-with-servicemanager/" class="subnavigation__link">Usage with zend-servicemanager</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../cookbook/aot-guide/" class="subnavigation__link">Using AoT with Expressive and zend-servicemanager</a>
    </li>

                            
                        </ul>
                    </li>
                
            
                
                    <li class="subnavigation__list-item ">
                        <a href="../../migration/" class="subnavigation__link">Migration Guide</a>
                    </li>
                
            
        </ul>
    </div>

                
            </div>
        </div>
    </div>

    
    <footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-9">
                <h5>Zend Framework</h5>
                <ul>
                    <li><a href="https://framework.zend.com/">framework.zend.com</a></li>
                    <li><a href="https://docs.zendframework.com">docs.zendframework.com</a></li>
                    <li><a href="https://packages.zendframework.com">packages.zendframework.com</a></li>
                    <li><a href="https://apigility.org">apigility.org</a></li>
                    <li><a href="https://getexpressive.org/">getexpressive.org</a></li>
                </ul>
            </div>
        </div>

        
        <div class="row">
            <div class="col-md-12 text-center">
                <a class="footer__button" href="#page-top"><i class="fa fa-chevron-up" aria-hidden="true"></i></a>
            </div>
        </div>

        <div class="row">

            
            <div class="col-md-9">
                <h4 class="footer__headline">Copyright</h4>
                <p>&copy; 2006-2018 by <a href="https://www.zend.com/">Zend</a>, a <a href="https://www.roguewave.com/">Rogue Wave Company</a>.</p>
            </div>

            
            <div class="col-md-3">
                <h4 class="footer__headline">Support</h4>
                <ul class="support__list">
                    <li class="support__list-item">
                        <a href="https://discourse.zendframework.com" class="support__link" title="Forum"><i class="fa fa-comments"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://zendframework-slack.herokuapp.com" class="support__link" title="Chat"><i class="fa fa-slack"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://github.com/zendframework" class="support__link" title="Github"><i class="fa fa-github"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://twitter.com/zfdevteam" class="support__link" title="Twitter"><i class="fa fa-twitter"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://tinyletter.com/mwopzend" class="support__link" title="Newsletter"><i class="fa fa-envelope"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://framework.zend.com/blog/feed-rss.xml" class="support__link" title="Blog feed"><i class="fa fa-rss"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://framework.zend.com/security/feed" class="support__link" title="Security feed"><i class="fa fa-rss-square"></i></a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</footer>

    <script>
        var base_url = '../..',
            siteName = 'zend-di';
    </script>
    <script src="../../js/scripts-a978f1ec1a.js"></script>
        <script src="../../search/require.js"></script>
        <script src="../../search/search.js"></script>

    
    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>



</body>


</html>
